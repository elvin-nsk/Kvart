# Kvart
Макрос для CorelDraw 16. Генерирует сетки для квартального календаря на основе шаблона.

## Принцип работы
Макрос берёт шаблон, состоящий из одной странички и копирует его в новый документ такого же размера, но состоящий из 14 страниц: декабрь предыдущего года, 12 месяцев года календаря и январь следующего. Весь дизайн копируется как есть, изменяются только специально помеченные элементы, по которым макрос строит сетку. Сетка может быть как стандартной пятистрочной (с дробью для не помещающихся дней месяца), так и шестистрочной. Редактированием шаблона можно построить вообще произвольную сетку. Могут быть убраны ненужные элементы (дни предыдущего/следующего месяца, номера недель). Выделяются основные праздничные дни РФ.

![превьюшка](https://github.com/elvin-nsk/Kvart/raw/master/preview.jpg)

## Установка
Копируем elvin_Kvart.gms в папку %APPDATA%\Corel\CorelDRAW Graphics Suite X6\Draw\GMS\

## Использование
Можно взять один из готовых шаблонов, поменять год в шаблоне на нужный, и запустить макрос. Макрос создаст календарь в новом документе. Шаблоны используют стандартные системные шрифты, так что с этим проблем возникнуть не должно.

## Устройство шаблона
Файл-шаблон состоит из элементов дизайна, которые не задействуются в работе макроса, а просто копируются на все листы, и из специальных объектов, имеющих имена. Имена можно увидеть в Object manager'е. Это год календаря, название месяца на русском, название на английском, шаблон номера недели, шаблон обычного дня, шаблон выходного/праздничного дня, шаблон дня предыдущего/следующего месяца и он же для выходного/праздника, а так же шаблон дробного дня. Кроме того, на странице-шаблоне есть 6 рамок для номера недели и 42 рамки для дней - эти рамки нужны для позиционирования элементов шаблона. Макрос находит объекты по именам. Шаблонные элементы раскладываются по рамкам так же, как они стоят относительно своих изначальных рамок. Все цвета, размеры, выключка текста - сохраняются.

Названия элементов шаблона и соответсвующие им изначальные рамки:
* YEAR - год, для которого создаётся календарь
* MONTH_RU - текущий месяц на русском
* MONTH_EN - текущий месяц на английском (опциональный)
* MONTH_NUM - номер текущего месяца (опциональный)
* WEEK_NUM - номер недели (опциональный)
* DAY_NUM - будний день - рамка DAY_FRAME_2
* SUN_NUM - выходной/праздничный день - рамка DAY_FRAME_7
* SMALLDAY_NUM - будний день предыдущего/следующего месяца (опциональный) - рамка DAY_FRAME_1
* SMALLSUN_NUM - выходной/праздничный день предыдущего/следующего месяца (опциональный) - рамка DAY_FRAME_6
* DAY_DUB - группа, внутри два именных элемента: NUM_TOP и NUM_BOT (верхний и нижний дни) - дробный день месяца (опциональный) - рамка DAY_FRAME_29

Опциональные элементы можно убрать из шаблона - календарь сгенерируется без них. При удалении одного из шаблонов для дней предыдущего месяца, календарь сгенерируется без них. Если убрать дробный день, то сгенерируется шестистрочный календарь без дробных дней. Если генерируется обычный календарь - то нижние незадействованные рамки убираются макросом - можно также убрать на шаблоне вручную.

При доработке/создании шаблона сетки важно сохранять или присваивать заново имена вышеуказанным элементам. Кроме того, важно сохранять одинаковый размер рамок. Сами рамки можно как закрашивать, так и делать бесцветными, если дизайн сетки не предусматривает квадратиков под числами.

Все названия и номера рамок вынесены в константы макроса, при необходимости их можно изменить.

## Прочее
Макрос создан в 16-м кореле, проверена работа в 15-м. На других версиях, особенно младших, может и не работать как надо.
